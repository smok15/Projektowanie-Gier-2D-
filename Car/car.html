<!DOCTYPE html>
<html>
	<body>
	  <canvas id="myCanvas" width="800" height="600" style="border:1px solid #000000;">
	  </canvas>
	</body>
	
	<script>
		var c = document.getElementById("myCanvas");
		var ctx = c.getContext("2d");
		var carPositionX = (c.width/2)-25;
		var carPositionY= (c.height)-80;
		var carX = 50;
		var carY = 80; 
		var enemyX= rand(150,600);
		
		var z=-140; var c=0; var h=0;
		var velocity =5;
		var rightPressed = false;
		var leftPressed = false;

		function rand(min, max) {
			min = Math.ceil(min);
			max = Math.floor(max);
			return Math.floor(Math.random() * (max - min)) + min;
		}

		document.addEventListener('keydown', function(e) {
			e.preventDefault();
			if (e.keyCode === 39) {
				rightPressed = true;
			}
			if (e.keyCode === 37) {
				leftPressed = true;
			}
		});

		document.addEventListener('keyup', function(e) {
			e.preventDefault();
			if (e.keyCode === 39) {
				rightPressed = false;
			}
			if (e.keyCode === 37) {
				leftPressed = false;
			}
		});

		function drawCar() {
			ctx.beginPath();
			ctx.rect(carPositionX, carPositionY, carX, carY);
			ctx.fillStyle = "black";
			ctx.fill();
			ctx.closePath();
		};

		function drawRoad(){
			ctx.beginPath();
			ctx.rect(150, 0, 500, 600);
			ctx.fillStyle = "gray";
			ctx.fill();
			ctx.closePath();
			ctx.beginPath();
			ctx.rect(0, 0, 100, 600);
			ctx.rect(700, 0, 100, 600);
			ctx.fillStyle = "green";
			ctx.fill();
			ctx.closePath();
			ctx.beginPath();
			ctx.rect(100, z, 50, 70); ctx.rect(650, z, 50, 70);
			ctx.rect(100, z+140, 50, 70); ctx.rect(650, z+140, 50, 70);
			ctx.rect(100, z+280, 50, 70); ctx.rect(650, z+280, 50, 70);
			ctx.rect(100, z+420, 50, 70); ctx.rect(650, z+420, 50, 70);
			ctx.rect(100, z+560, 50, 70); ctx.rect(650, z+560, 50, 70);
			ctx.fillStyle = "red";
			ctx.fill();
			ctx.closePath();
			ctx.beginPath();
			ctx.rect(245, z, 10, 70); ctx.rect(345, z, 10, 70); ctx.rect(445, z, 10, 70); ctx.rect(545, z, 10, 70);
			ctx.rect(245, z+140, 10, 70); ctx.rect(345, z+140, 10, 70); ctx.rect(445, z+140, 10, 70); ctx.rect(545, z+140, 10, 70);
			ctx.rect(245, z+280, 10, 70); ctx.rect(345, z+280, 10, 70); ctx.rect(445, z+280, 10, 70); ctx.rect(545, z+280, 10, 70);
			ctx.rect(245, z+420, 10, 70); ctx.rect(345, z+420, 10, 70); ctx.rect(445, z+420, 10, 70); ctx.rect(545, z+420, 10, 70);
			ctx.rect(245, z+560, 10, 70); ctx.rect(345, z+560, 10, 70); ctx.rect(445, z+560, 10, 70); ctx.rect(545, z+560, 10, 70);
			ctx.fillStyle = "white";
			ctx.fill();
			ctx.closePath();
		};

		function spawnEnemy(){
			ctx.beginPath();
			ctx.rect(enemyX, 0+h, carX, carY);
			ctx.fillStyle = "black";
			ctx.fill();
			ctx.closePath();
		}

		function animate(){
			ctx.clearRect(0,0, 800,600);
			window.requestAnimationFrame(animate);

			if (rightPressed && carPositionX<600) {
        		 carPositionX += velocity;
    		} else if (leftPressed && carPositionX>150) {
        		carPositionX -= velocity;
    		};
			z+=5;c+=5;h+=5;

			drawRoad();

			if (c%140==0){
				z=-140;
				drawRoad();
			};
			spawnEnemy();
			drawCar();
		};
		animate();
	</script>
</html>