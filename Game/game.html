<!DOCTYPE html>
<html>
	<body>
	  <canvas id="myCanvas" width="800" height="600" style="border:1px solid #000000;">
	  </canvas>
	</body>
	
	<script>
	var c = document.getElementById("myCanvas");
	var ctx= c.getContext('2d');
	
	var rectWidth = 50;
	var rectHeight = 30;

	
	var rectX = (c.width-rectWidth)/2;
	var rectY = c.height-rectHeight;
	
	var radius = 7;
	var bulletX = rectX+(rectWidth/2);
	var bulletY = rectY-radius;
	var vel =8;
	
	var shootFlag=false;
	var targetR;
	var targetX;
	var targetY;
	var distance;
	var counter = 0;
	
	
	function drawRect(){
		ctx.beginPath();
		ctx.rect(rectX,rectY,rectWidth,rectHeight);
		ctx.fillStyle="red";
		ctx.fill();
		ctx.closePath();
	}
	
	function drawBullet(){
		ctx.beginPath();
		ctx.arc(rectX+(rectWidth/2),bulletY,radius,0,Math.PI*2,true);
		ctx.fillStyle="red";
		ctx.fill();
		ctx.closePath();
	}
	
	function draw(){
			ctx.clearRect(0,0, 800,600);
			drawTarget();
			drawRect();
	}
	
	function bulletLogic(){
		if(bulletY>0 && shootFlag && collision()){
			ctx.clearRect(0,0, 800,600);
			drawRect();
			drawTarget();
			drawBullet();
			bulletY-=vel;
		}else{
			bulletY=rectY-radius;
			shootFlag=false;
			clearInterval(t);
		}
	}

	function rand(min, max) {
		min = Math.ceil(min);
		max = Math.floor(max);
		return Math.floor(Math.random() * (max - min)) + min;
	}
	
	function generateTarget()
	{
		targetR = rand(20,50);
		targetX = rand(targetR,c.width-targetR);
		targetY = rand(targetR,150);
	}

	function drawTarget(){
		ctx.beginPath();
		ctx.arc(targetX,targetY,targetR,0,Math.PI*2,true);
		ctx.fillStyle="red";
		ctx.fill();
		ctx.closePath();
	}
	
	function collision(){
		distance = Math.hypot(bulletX - targetX, bulletY - targetY);
		if ((distance - targetR - radius )<1){
			ctx.clearRect(0,0,800,150);
			generateTarget();
			distance = 0;
			counter+=1;
			return true;
		}else return false;
	}
	
	document.addEventListener('keydown', function (e) {
        switch (e.keyCode) {
            case 37:
				if(rectX>0)rectX-=vel;
				draw();
                break;
            case 39:
				if(rectX<800-rectWidth)rectX+=vel;
				draw();
                break;
			case 32:
				shootFlag=true;
				t = setInterval(bulletLogic,10);
                break;
        }
    });
	generateTarget();
	draw();
	</script>
</html>